#!/usr/bin/env python
from pwn import *
from ctypes import *

context.arch = 'amd64'

host = 'pre-exam-pwn.ais3.org'
y = remote( host , 10007 )

def login( usr , pwd ):
    y.sendafter( '>' , '2' )
    y.sendafter( ':' , usr )
    y.sendafter( ':' , pwd )

def logout():
    y.sendafter( '>' , '5' )

def new( data ):
    y.sendafter( '>' , '1' )
    y.sendlineafter( '> ' , data )

def update( idx , data ):
    y.sendafter( '>' , '2' )
    y.sendafter( '?' , str( idx ) )
    y.sendafter( '> ' , data )

def dle( idx ):
    y.sendafter( '>' , '4' )
    y.sendafter( '?' , str( idx ) )


y.sendafter( '>' , '1' )
y.sendafter( ':' , 'a' )
y.sendafter( ':' , 'b' )

login( 'a' , 'b' )


y.interactive()